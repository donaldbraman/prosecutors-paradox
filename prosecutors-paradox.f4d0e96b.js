let singleChart,multipleChart,comparisonRateInput=document.getElementById("comparison_rate"),targetRateInput=document.getElementById("target_rate"),avgFirstInput=document.getElementById("avg_first"),avgSecondInput=document.getElementById("avg_second"),avgThirdInput=document.getElementById("avg_third"),runSimulationButton=document.getElementById("run_simulation"),comparisonGrid=document.getElementById("comparison_grid"),targetGrid=document.getElementById("target_grid"),singleChartCanvas=document.getElementById("single_sim_chart"),multipleChartCanvas=document.getElementById("multiple_sims_chart"),singleChartCtx=singleChartCanvas.getContext("2d"),multipleChartCtx=multipleChartCanvas.getContext("2d"),gridSize=10,comparisonPeople=[],targetPeople=[];function validateInputs(){let e=!0;return[comparisonRateInput,targetRateInput,avgFirstInput,avgSecondInput,avgThirdInput].forEach(t=>{let r=parseFloat(t.value);t.id.includes("rate")?r<0||r>100?(t.style.borderColor="red",e=!1):t.style.borderColor="#ccc":r<0||r>10?(t.style.borderColor="red",e=!1):t.style.borderColor="#ccc"}),e}function initializePeople(){comparisonPeople=Array.from({length:100},()=>({arrests:0,sentenceServed:0,sentenceRemaining:0,x:Math.random(),y:Math.random()})),targetPeople=Array.from({length:100},()=>({arrests:0,sentenceServed:0,sentenceRemaining:0,x:Math.random(),y:Math.random()}))}function drawGrid(e,t,r){e.innerHTML="",t.forEach(t=>{if(t.arrests>0){let o=document.createElement("div");o.className=`dot ${r?"comparison-dot":"target-dot"}`;let a=8+(t.arrests-1)*4;o.style.width=`${a}px`,o.style.height=`${a}px`,o.style.left=`${100*t.x}%`,o.style.top=`${100*t.y}%`,e.appendChild(o)}})}function getSentence(e){let t=parseFloat(avgFirstInput.value),r=parseFloat(avgSecondInput.value),o=parseFloat(avgThirdInput.value);return 1===e?t:2===e?r:o}function simulateArrests(e,t){let r=e.filter(e=>e.sentenceRemaining<=0),o=Math.round(r.length*t);for(let e=0;e<o&&0!==r.length;e++){let e=Math.floor(Math.random()*r.length),t=r[e];t.arrests++;let o=getSentence(t.arrests);t.sentenceRemaining=o,r.splice(e,1)}}function updateSentences(e){e.forEach(e=>{e.sentenceRemaining>0&&(e.sentenceServed++,e.sentenceRemaining--)})}function getChartOptions(e){return{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{title:{display:!0,display:!1,text:e,font:{size:18,weight:"600",family:"'Arial', 'Helvetica Neue', sans-serif"},color:"#2c3e50"},legend:{position:"top",align:"center",labels:{padding:8,usePointStyle:!0,pointStyle:"circle",font:{size:13,family:"'Arial', 'Helvetica Neue', sans-serif"},generateLabels:function(e){return Chart.defaults.plugins.legend.labels.generateLabels(e)},boxWidth:8,boxHeight:8,color:"#2c3e50"}},tooltip:{backgroundColor:"rgba(255, 255, 255, 0.95)",titleColor:"#2c3e50",titleFont:{size:14,weight:"600",family:"'Arial', 'Helvetica Neue', sans-serif"},bodyColor:"#34495e",bodyFont:{size:13,family:"'Arial', 'Helvetica Neue', sans-serif"},borderColor:"rgba(0,0,0,0.1)",borderWidth:1,padding:12,cornerRadius:6,displayColors:!0,boxWidth:8,boxHeight:8,callbacks:{label:e=>{let t=e.dataset,r=e.parsed.y,o=`${t.label}: ${r.toFixed(1)} years`;if(t.errorBars&&t.errorBars.plus){let r=t.errorBars.plus[e.dataIndex];r>0&&(o+=` \xb1${r.toFixed(1)}`)}return o}}}},layout:{padding:{top:10,bottom:20,left:15,right:0}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cumulative Sentence Years",padding:{top:5,bottom:5},font:{size:14,weight:"600",family:"'Arial', 'Helvetica Neue', sans-serif"},color:"#2c3e50"},ticks:{font:{size:12,family:"'Arial', 'Helvetica Neue', sans-serif"},color:"#34495e",padding:5},grid:{color:"rgba(0,0,0,0.05)",drawBorder:!1}},x:{title:{display:!0,text:"Simulation Year",padding:{top:5,bottom:5},font:{size:14,weight:"600",family:"'Arial', 'Helvetica Neue', sans-serif"},color:"#2c3e50"},ticks:{font:{size:12,family:"'Arial', 'Helvetica Neue', sans-serif"},color:"#34495e",padding:5},grid:{color:"rgba(0,0,0,0.05)",drawBorder:!1}}}}}function runSimulation(){if(!validateInputs())return void alert("Please check input values. Arrest rates must be between 0-100%, sentences between 0-10 years.");initializePeople();let e=parseFloat(comparisonRateInput.value)/100,t=parseFloat(targetRateInput.value)/100,r=[],o=[];for(let a=0;a<20;a++){simulateArrests(comparisonPeople,e),simulateArrests(targetPeople,t),updateSentences(comparisonPeople),updateSentences(targetPeople);let a=comparisonPeople.reduce((e,t)=>e+t.sentenceServed,0),n=targetPeople.reduce((e,t)=>e+t.sentenceServed,0);r.push(a),o.push(n),drawGrid(comparisonGrid,comparisonPeople,!0),drawGrid(targetGrid,targetPeople,!1)}renderSingleSimChart(r,o)}function renderSingleSimChart(e,t){singleChart&&singleChart.destroy(),singleChart=new Chart(singleChartCtx,{type:"line",data:{labels:Array.from({length:20},(e,t)=>`Year ${t+1}`),datasets:[{label:"Targeted Cohort",data:t,borderColor:"#D32F2F",borderWidth:2.5,tension:.3,pointRadius:4,pointHoverRadius:6,pointBackgroundColor:"#D32F2F",pointBorderColor:"#fff",pointBorderWidth:2,pointHoverBackgroundColor:"#D32F2F",pointHoverBorderColor:"#fff",pointHoverBorderWidth:2,fill:!1},{label:"Comparison Cohort",data:e,borderColor:"#1976D2",borderWidth:2.5,tension:.3,pointRadius:4,pointHoverRadius:6,pointBackgroundColor:"#1976D2",pointBorderColor:"#fff",pointBorderWidth:2,pointHoverBackgroundColor:"#1976D2",pointHoverBorderColor:"#fff",pointHoverBorderWidth:2,fill:!1}]},options:getChartOptions("Single Simulation Results")})}function calculateStats(e){let t=e[0].length,r=Array(t).fill(0),o=Array(t).fill(0);for(let o=0;o<t;o++)r[o]=e.reduce((e,t)=>e+t[o],0)/e.length;for(let a=0;a<t;a++){let t=e.map(e=>Math.pow(e[a]-r[a],2)).reduce((e,t)=>e+t,0)/e.length;o[a]=Math.sqrt(t)}return{means:r,stdDevs:o}}function runMultipleSimulations(){if(!validateInputs())return void alert("Please check input values. Arrest rates must be between 0-100%, sentences between 0-10 years.");let e=[],t=[];for(let r=0;r<1e4;r++){initializePeople();let r=parseFloat(comparisonRateInput.value)/100,o=parseFloat(targetRateInput.value)/100,a=[],n=[];for(let e=0;e<20;e++){simulateArrests(comparisonPeople,r),simulateArrests(targetPeople,o),updateSentences(comparisonPeople),updateSentences(targetPeople);let e=comparisonPeople.reduce((e,t)=>e+t.sentenceServed,0),t=targetPeople.reduce((e,t)=>e+t.sentenceServed,0);a.push(e),n.push(t)}e.push(a),t.push(n)}renderMultipleSimsChart(calculateStats(e),calculateStats(t))}let ratioTextPlugin={id:"ratioText",beforeDraw:(e,t,r)=>{let{ctx:o,chartArea:{left:a,top:n,right:i,bottom:l}}=e;if(!r.text)return;o.save(),o.font='16px Arial, "Helvetica Neue", sans-serif',o.fillStyle="#2c3e50",o.textAlign="left",o.textBaseline="top";let s=a+(i-a)*.05,d=n+(l-n)*.05,p=r.text.split("\n"),u=Math.max(...p.map(e=>o.measureText(e).width));o.fillStyle="rgba(255, 255, 255, 0.9)",o.fillRect(s-20,d-20,u+40,28*p.length+40),o.fillStyle="#2c3e50",p.forEach((e,t)=>{o.fillText(e,s,d+28*t)}),o.restore()}};function renderMultipleSimsChart(e,t){multipleChart&&multipleChart.destroy();let r=Array.from({length:20},(e,t)=>`Year ${t+1}`),o=t.means[19]/e.means[19],a=`For every year that people in the comparison cohort
are incarcerated for criminal conduct, people in the
targeted cohort engaging in the same conduct
spend ${o.toFixed(1)} years incarcerated.`;multipleChart=new Chart(multipleChartCtx,{type:"line",data:{labels:r,datasets:[{label:"Targeted Cohort",data:t.means,borderColor:"#D32F2F",borderWidth:2.5,tension:.3,pointRadius:4,pointHoverRadius:6,pointBackgroundColor:"#D32F2F",pointBorderColor:"#fff",pointBorderWidth:2,pointHoverBackgroundColor:"#D32F2F",pointHoverBorderColor:"#fff",pointHoverBorderWidth:2,fill:!1,errorBars:{plus:t.stdDevs,minus:t.stdDevs,color:"rgba(211, 47, 47, 0.3)"}},{label:"Comparison Cohort",data:e.means,borderColor:"#1976D2",borderWidth:2.5,tension:.3,pointRadius:4,pointHoverRadius:6,pointBackgroundColor:"#1976D2",pointBorderColor:"#fff",pointHoverBackgroundColor:"#1976D2",pointHoverBorderColor:"#fff",pointHoverBorderWidth:2,fill:!1,errorBars:{plus:e.stdDevs,minus:e.stdDevs,color:"rgba(25, 118, 210, 0.3)"}}]},options:{...getChartOptions("Multiple Simulations Results (with Standard Deviation)"),plugins:{...getChartOptions("").plugins,ratioText:{text:a}}}})}Chart.register(ratioTextPlugin),runSimulationButton.addEventListener("click",()=>{runSimulation(),drawGrid(comparisonGrid,comparisonPeople,!0),drawGrid(targetGrid,targetPeople,!1)}),document.getElementById("run_multiple_simulations").addEventListener("click",()=>{runMultipleSimulations()}),runSimulation();
//# sourceMappingURL=prosecutors-paradox.f4d0e96b.js.map
